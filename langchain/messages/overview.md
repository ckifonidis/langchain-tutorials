# Messages in LangChain

## Overview
Messages are the fundamental unit of communication in LangChain's chat interfaces. They represent structured exchanges between users, the system, and AI models.

## Message Types

### 1. SystemMessage
```python
from langchain_core.messages import SystemMessage

system_msg = SystemMessage(content="You are a helpful assistant.")
```
- Sets behavior and context
- Provides guidelines
- Configures model role
- Not visible to users

### 2. HumanMessage
```python
from langchain_core.messages import HumanMessage

human_msg = HumanMessage(content="What is machine learning?")
```
- Represents user input
- Main interaction point
- Can include attachments
- Maintains conversation flow

### 3. AIMessage
```python
from langchain_core.messages import AIMessage

ai_msg = AIMessage(content="Machine learning is...")
```
- Contains model responses
- Generated by LLM
- May include metadata
- Can be structured

### 4. FunctionMessage
```python
from langchain_core.messages import FunctionMessage

function_msg = FunctionMessage(name="tool_name", content="result")
```
- Tool execution results
- Function call outputs
- Structured data
- System interactions

## Message Properties

### 1. Content
- Main message text
- Can be multimodal
- Supports formatting
- May be structured

### 2. Additional Keywords
- Metadata
- Timestamps
- Role information
- Custom data

### 3. Response Metadata
- Token counts
- Model information
- Timing data
- Processing details

## Common Patterns

### 1. Conversation Building
```python
messages = [
    SystemMessage(content="System instruction"),
    HumanMessage(content="User question"),
    AIMessage(content="AI response")
]
```

### 2. Message Chain
```python
chain = prompt | llm | output_parser
result = chain.invoke(messages)
```

### 3. History Management
```python
history = []
history.append(HumanMessage(content="Question"))
history.append(AIMessage(content="Answer"))
```

## Best Practices

### 1. Message Creation
- Use appropriate types
- Include necessary context
- Validate content
- Handle errors

### 2. Message Handling
- Maintain sequence
- Preserve context
- Clean invalid messages
- Handle timeouts

### 3. Message Storage
- Efficient storage
- Context management
- History pruning
- State persistence

## Common Use Cases

### 1. Chat Applications
- Conversational agents
- Support systems
- Educational tools
- Interactive assistants

### 2. Tool Integration
- Function calling
- API interactions
- System commands
- Data processing

### 3. State Management
- Session handling
- Context preservation
- History tracking
- User preferences

## Security Considerations

### 1. Content Validation
- Input sanitization
- Output validation
- Content filtering
- Error handling

### 2. Privacy
- Data protection
- Message encryption
- PII handling
- Access control

### 3. Storage
- Secure persistence
- Data retention
- Access logging
- Cleanup policies

## Message Formatting

### 1. Text Content
```python
message = HumanMessage(content="Plain text content")
```

### 2. Structured Content
```python
message = AIMessage(
    content="Response",
    additional_kwargs={
        "metadata": {"key": "value"},
        "timestamp": "2024-03-14"
    }
)
```

### 3. Multimodal Content
```python
message = HumanMessage(
    content=[
        {"type": "text", "text": "Description"},
        {"type": "image_url", "image_url": "url"}
    ]
)
```

## Related Concepts

### 1. Chat Models
- Message processing
- Response generation
- Context handling
- Tool integration

### 2. Memory Systems
- Message storage
- History management
- Context windows
- State persistence

### 3. Output Parsing
- Message extraction
- Content formatting
- Data validation
- Error handling